import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model  import LinearRegression
from sklearn.metrics       import r2_score

# Load datasets
uci  = pd.read_csv("uci_diabetes.csv")
pima = pd.read_csv("pima_diabetes.csv")

features = ["Glucose", "BloodPressure", "Age"]
target   = "BMI"

def run_multiple(df, name):
    X = df[features]
    y = df[target]
    Xtr, Xte, ytr, yte = train_test_split(X, y, test_size=0.2, random_state=0)
    model = LinearRegression().fit(Xtr, ytr)
    r2 = r2_score(yte, model.predict(Xte))
    print(f"{name} Multiple Regression RÂ² = {r2:.4f}")
    return r2

r2_uci_multi  = run_multiple(uci,  "UCI")
r2_pima_multi = run_multiple(pima, "Pima")
